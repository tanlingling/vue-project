{"remainingRequest":"/Users/tanlingling/Desktop/sell/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/tanlingling/Desktop/sell/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/tanlingling/Desktop/sell/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tanlingling/Desktop/sell/node_modules/cube-ui/src/components/index-list/index-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tanlingling/Desktop/sell/node_modules/cube-ui/src/components/index-list/index-list.vue","mtime":499162500000},{"path":"/Users/tanlingling/Desktop/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tanlingling/Desktop/sell/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/tanlingling/Desktop/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tanlingling/Desktop/sell/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.fixed\";\nimport _parseInt from \"/Users/tanlingling/Desktop/sell/node_modules/@babel/runtime-corejs2/core-js/parse-int\";\nimport _Object$assign from \"/Users/tanlingling/Desktop/sell/node_modules/@babel/runtime-corejs2/core-js/object/assign\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getData, getRect, prefixStyle, getMatchedTarget } from '../../common/helpers/dom';\nimport { inBrowser } from '../../common/helpers/env';\nimport CubeScroll from '../scroll/scroll.vue';\nimport CubeIndexListGroup from './index-list-group.vue';\nimport scrollMixin from '../../common/mixins/scroll';\nimport deprecatedMixin from '../../common/mixins/deprecated';\nvar COMPONENT_NAME = 'cube-index-list';\nvar EVENT_SELECT = 'select';\nvar EVENT_TITLE_CLICK = 'title-click';\nvar EVENT_PULLING_UP = 'pulling-up';\nvar EVENT_PULLING_DOWN = 'pulling-down';\nvar ANCHOR_HEIGHT = inBrowser ? window.innerHeight <= 480 ? 17 : 18 : 18;\nvar transformStyleKey = prefixStyle('transform');\nexport default {\n  name: COMPONENT_NAME,\n  mixins: [scrollMixin, deprecatedMixin],\n  props: {\n    title: {\n      type: String,\n      default: ''\n    },\n    data: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    speed: {\n      type: Number,\n      default: 0\n    },\n    navbar: {\n      type: Boolean,\n      default: true\n    },\n    pullDownRefresh: {\n      type: [Object, Boolean],\n      default: undefined,\n      deprecated: {\n        replacedBy: 'options'\n      }\n    },\n    pullUpLoad: {\n      type: [Object, Boolean],\n      default: undefined,\n      deprecated: {\n        replacedBy: 'options'\n      }\n    }\n  },\n  data: function data() {\n    return {\n      scrollEvents: ['scroll'],\n      currentIndex: 0,\n      scrollY: -1,\n      diff: -1,\n      titleHeight: 0\n    };\n  },\n  computed: {\n    fixedTitle: function fixedTitle() {\n      this.title && !this.titleHeight && this._caculateTitleHeight();\n      return this.scrollY <= -this.titleHeight && this.data[this.currentIndex] ? this.data[this.currentIndex].name : '';\n    },\n    shortcutList: function shortcutList() {\n      return this.data.map(function (group) {\n        return group ? group.shortcut || group.name.substr(0, 1) : '';\n      });\n    },\n    scrollOptions: function scrollOptions() {\n      return _Object$assign({}, {\n        pullDownRefresh: this.pullDownRefresh,\n        pullUpLoad: this.pullUpLoad\n      }, this.options);\n    }\n  },\n  created: function created() {\n    this.groupList = [];\n    this.listHeight = [];\n    this.touch = {};\n    this.subTitleHeight = 0;\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    this.$nextTick(function () {\n      _this.title && _this._caculateTitleHeight();\n\n      _this._calculateHeight();\n    });\n  },\n  methods: {\n    /* TODO: remove refresh next minor version */\n    refresh: function refresh() {\n      this.$refs.scroll.refresh();\n    },\n    selectItem: function selectItem(item) {\n      this.$emit(EVENT_SELECT, item);\n    },\n    scroll: function scroll(pos) {\n      this.scrollY = pos.y;\n    },\n    titleClick: function titleClick() {\n      this.$emit(EVENT_TITLE_CLICK, this.title);\n    },\n    forceUpdate: function forceUpdate() {\n      this.$refs.scroll.forceUpdate();\n    },\n    onShortcutTouchStart: function onShortcutTouchStart(e) {\n      var target = getMatchedTarget(e, 'cube-index-list-nav-item');\n      if (!target) return;\n      var anchorIndex = getData(target, 'index');\n      var firstTouch = e.touches[0];\n      this.touch.y1 = firstTouch.pageY;\n      this.touch.anchorIndex = anchorIndex;\n\n      this._scrollTo(anchorIndex);\n    },\n    onShortcutTouchMove: function onShortcutTouchMove(e) {\n      var firstTouch = e.touches[0];\n      this.touch.y2 = firstTouch.pageY;\n      var delta = (this.touch.y2 - this.touch.y1) / ANCHOR_HEIGHT | 0;\n      var anchorIndex = _parseInt(this.touch.anchorIndex) + delta;\n\n      this._scrollTo(anchorIndex);\n    },\n    onPullingUp: function onPullingUp() {\n      this.$emit(EVENT_PULLING_UP);\n    },\n    onPullingDown: function onPullingDown() {\n      this.$emit(EVENT_PULLING_DOWN);\n    },\n    _caculateTitleHeight: function _caculateTitleHeight() {\n      this.titleHeight = this.$refs.title ? getRect(this.$refs.title).height : 0;\n    },\n    _calculateHeight: function _calculateHeight() {\n      this.groupList = this.$el.getElementsByClassName('cube-index-list-group');\n      var subTitleEl = this.$el.getElementsByClassName('cube-index-list-anchor')[0];\n      this.subTitleHeight = subTitleEl ? getRect(subTitleEl).height : 0;\n      this.listHeight = [];\n\n      if (!this.groupList) {\n        return;\n      }\n\n      var height = this.titleHeight;\n      this.listHeight.push(height);\n\n      for (var i = 0; i < this.groupList.length; i++) {\n        var item = this.groupList[i];\n        height += item.clientHeight;\n        this.listHeight.push(height);\n      }\n    },\n    _scrollTo: function _scrollTo(index) {\n      if (index < 0) {\n        index = 0;\n      } else if (index > this.listHeight.length - 2) {\n        index = this.listHeight.length - 2;\n      }\n\n      this.$refs.scroll.scrollToElement(this.groupList[index], this.speed);\n      this.scrollY = this.$refs.scroll.scroll.y;\n    }\n  },\n  watch: {\n    data: function data() {\n      var _this2 = this;\n\n      this.$nextTick(function () {\n        _this2._calculateHeight();\n      });\n    },\n    title: function title(newVal) {\n      var _this3 = this;\n\n      this.$nextTick(function () {\n        _this3._caculateTitleHeight();\n\n        _this3._calculateHeight();\n      });\n    },\n    diff: function diff(newVal) {\n      var fixedTop = newVal > 0 && newVal < this.subTitleHeight ? newVal - this.subTitleHeight : 0;\n\n      if (this.fixedTop === fixedTop) {\n        return;\n      }\n\n      this.fixedTop = fixedTop;\n      this.$refs.fixed.style[transformStyleKey] = \"translate3d(0,\".concat(fixedTop, \"px,0)\");\n    },\n    scrollY: function scrollY(newY) {\n      var listHeight = this.listHeight; // top\n\n      if (newY > -this.titleHeight) {\n        this.currentIndex = 0;\n        return;\n      } // midd\n\n\n      for (var i = 0; i < listHeight.length - 1; i++) {\n        var height1 = listHeight[i];\n        var height2 = listHeight[i + 1];\n\n        if (-newY >= height1 && -newY < height2) {\n          this.currentIndex = i;\n          this.diff = height2 + newY;\n          return;\n        }\n      } // bottom\n\n\n      this.currentIndex = listHeight.length - 2;\n    }\n  },\n  components: {\n    CubeScroll: CubeScroll,\n    CubeIndexListGroup: CubeIndexListGroup\n  }\n};",{"version":3,"sources":["index-list.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"cube-index-list\">\n    <cube-scroll\n      ref=\"scroll\"\n      :scroll-events=\"scrollEvents\"\n      :options=\"scrollOptions\"\n      :data=\"data\"\n      @scroll=\"scroll\"\n      @pulling-down=\"onPullingDown\"\n      @pulling-up=\"onPullingUp\">\n      <div class=\"cube-index-list-content\" ref=\"content\">\n        <h1 class=\"cube-index-list-title\" v-if=\"title\" ref=\"title\" @click=\"titleClick\">\n          {{ title }}\n        </h1>\n        <ul>\n          <slot>\n            <cube-index-list-group v-for=\"(group, index) in data\" :key=\"index\" :group=\"group\" @select=\"selectItem\">\n            </cube-index-list-group>\n          </slot>\n        </ul>\n      </div>\n      <template v-if=\"$slots.pullup || $scopedSlots.pullup\" slot=\"pullup\" slot-scope=\"props\">\n        <slot name=\"pullup\"\n          :pullUpLoad=\"props.pullUpLoad\"\n          :isPullUpLoad=\"props.isPullUpLoad\">\n        </slot>\n      </template>\n      <template v-if=\"$slots.pulldown || $scopedSlots.pulldown\" slot=\"pulldown\" slot-scope=\"props\">\n        <slot name=\"pulldown\"\n          :pullDownRefresh=\"props.pullDownRefresh\"\n          :pullDownStyle=\"props.pullDownStyle\"\n          :beforePullDown=\"props.beforePullDown\"\n          :isPullingDown=\"props.isPullingDown\"\n          :bubbleY=\"props.bubbleY\">\n        </slot>\n      </template>\n    </cube-scroll>\n    <div v-if=\"navbar\" class=\"cube-index-list-nav\" @touchstart=\"onShortcutTouchStart\" @touchmove.stop.prevent=\"onShortcutTouchMove\">\n      <ul class=\"cube-index-list-nav-list\">\n        <li\n          v-for=\"(item, index) in shortcutList\"\n          :key=\"index\"\n          :data-index=\"index\"\n          class=\"cube-index-list-nav-item\"\n          :class=\"{active: currentIndex === index}\"\n        >\n          <slot name=\"nav-item\" :item=\"item\">{{ item }}</slot>\n        </li>\n      </ul>\n    </div>\n    <div ref=\"fixed\"\n      v-show=\"fixedTitle\"\n      v-html=\"fixedTitle\"\n      class=\"cube-index-list-fixed cube-index-list-anchor\">\n    </div>\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\n  import {\n    getData,\n    getRect,\n    prefixStyle,\n    getMatchedTarget\n  } from '../../common/helpers/dom'\n  import { inBrowser } from '../../common/helpers/env'\n\n  import CubeScroll from '../scroll/scroll.vue'\n  import CubeIndexListGroup from './index-list-group.vue'\n  import scrollMixin from '../../common/mixins/scroll'\n  import deprecatedMixin from '../../common/mixins/deprecated'\n\n  const COMPONENT_NAME = 'cube-index-list'\n  const EVENT_SELECT = 'select'\n  const EVENT_TITLE_CLICK = 'title-click'\n  const EVENT_PULLING_UP = 'pulling-up'\n  const EVENT_PULLING_DOWN = 'pulling-down'\n\n  const ANCHOR_HEIGHT = inBrowser ? window.innerHeight <= 480 ? 17 : 18 : 18\n  const transformStyleKey = prefixStyle('transform')\n\n  export default {\n    name: COMPONENT_NAME,\n    mixins: [scrollMixin, deprecatedMixin],\n    props: {\n      title: {\n        type: String,\n        default: ''\n      },\n      data: {\n        type: Array,\n        default() {\n          return []\n        }\n      },\n      speed: {\n        type: Number,\n        default: 0\n      },\n      navbar: {\n        type: Boolean,\n        default: true\n      },\n      pullDownRefresh: {\n        type: [Object, Boolean],\n        default: undefined,\n        deprecated: {\n          replacedBy: 'options'\n        }\n      },\n      pullUpLoad: {\n        type: [Object, Boolean],\n        default: undefined,\n        deprecated: {\n          replacedBy: 'options'\n        }\n      }\n    },\n    data() {\n      return {\n        scrollEvents: ['scroll'],\n        currentIndex: 0,\n        scrollY: -1,\n        diff: -1,\n        titleHeight: 0\n      }\n    },\n    computed: {\n      fixedTitle() {\n        this.title && !this.titleHeight && this._caculateTitleHeight()\n\n        return this.scrollY <= -this.titleHeight && this.data[this.currentIndex] ? this.data[this.currentIndex].name : ''\n      },\n      shortcutList() {\n        return this.data.map((group) => {\n          return group ? group.shortcut || group.name.substr(0, 1) : ''\n        })\n      },\n      scrollOptions() {\n        return Object.assign({}, {\n          pullDownRefresh: this.pullDownRefresh,\n          pullUpLoad: this.pullUpLoad\n        }, this.options)\n      }\n    },\n    created() {\n      this.groupList = []\n      this.listHeight = []\n      this.touch = {}\n      this.subTitleHeight = 0\n    },\n    mounted() {\n      this.$nextTick(() => {\n        this.title && this._caculateTitleHeight()\n        this._calculateHeight()\n      })\n    },\n    methods: {\n      /* TODO: remove refresh next minor version */\n      refresh() {\n        this.$refs.scroll.refresh()\n      },\n      selectItem(item) {\n        this.$emit(EVENT_SELECT, item)\n      },\n      scroll(pos) {\n        this.scrollY = pos.y\n      },\n      titleClick() {\n        this.$emit(EVENT_TITLE_CLICK, this.title)\n      },\n      forceUpdate() {\n        this.$refs.scroll.forceUpdate()\n      },\n      onShortcutTouchStart(e) {\n        const target = getMatchedTarget(e, 'cube-index-list-nav-item')\n        if (!target) return\n        let anchorIndex = getData(target, 'index')\n        let firstTouch = e.touches[0]\n        this.touch.y1 = firstTouch.pageY\n        this.touch.anchorIndex = anchorIndex\n\n        this._scrollTo(anchorIndex)\n      },\n      onShortcutTouchMove(e) {\n        let firstTouch = e.touches[0]\n        this.touch.y2 = firstTouch.pageY\n        let delta = (this.touch.y2 - this.touch.y1) / ANCHOR_HEIGHT | 0\n        let anchorIndex = parseInt(this.touch.anchorIndex) + delta\n\n        this._scrollTo(anchorIndex)\n      },\n      onPullingUp() {\n        this.$emit(EVENT_PULLING_UP)\n      },\n      onPullingDown() {\n        this.$emit(EVENT_PULLING_DOWN)\n      },\n      _caculateTitleHeight() {\n        this.titleHeight = this.$refs.title ? getRect(this.$refs.title).height : 0\n      },\n      _calculateHeight() {\n        this.groupList = this.$el.getElementsByClassName('cube-index-list-group')\n        const subTitleEl = this.$el.getElementsByClassName('cube-index-list-anchor')[0]\n        this.subTitleHeight = subTitleEl ? getRect(subTitleEl).height : 0\n        this.listHeight = []\n\n        if (!this.groupList) {\n          return\n        }\n\n        let height = this.titleHeight\n        this.listHeight.push(height)\n        for (let i = 0; i < this.groupList.length; i++) {\n          let item = this.groupList[i]\n          height += item.clientHeight\n          this.listHeight.push(height)\n        }\n      },\n      _scrollTo(index) {\n        if (index < 0) {\n          index = 0\n        } else if (index > this.listHeight.length - 2) {\n          index = this.listHeight.length - 2\n        }\n        this.$refs.scroll.scrollToElement(this.groupList[index], this.speed)\n        this.scrollY = this.$refs.scroll.scroll.y\n      }\n    },\n    watch: {\n      data() {\n        this.$nextTick(() => {\n          this._calculateHeight()\n        })\n      },\n      title(newVal) {\n        this.$nextTick(() => {\n          this._caculateTitleHeight()\n          this._calculateHeight()\n        })\n      },\n      diff(newVal) {\n        let fixedTop = (newVal > 0 && newVal < this.subTitleHeight) ? newVal - this.subTitleHeight : 0\n        if (this.fixedTop === fixedTop) {\n          return\n        }\n        this.fixedTop = fixedTop\n        this.$refs.fixed.style[transformStyleKey] = `translate3d(0,${fixedTop}px,0)`\n      },\n      scrollY(newY) {\n        const listHeight = this.listHeight\n        // top\n        if (newY > -this.titleHeight) {\n          this.currentIndex = 0\n          return\n        }\n        // midd\n        for (let i = 0; i < listHeight.length - 1; i++) {\n          let height1 = listHeight[i]\n          let height2 = listHeight[i + 1]\n          if (-newY >= height1 && -newY < height2) {\n            this.currentIndex = i\n            this.diff = height2 + newY\n            return\n          }\n        }\n        // bottom\n        this.currentIndex = listHeight.length - 2\n      }\n    },\n    components: {\n      CubeScroll,\n      CubeIndexListGroup\n    }\n  }\n</script>\n\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n  @require \"../../common/stylus/variable.styl\"\n  @require \"../../common/stylus/mixin.styl\"\n\n  .cube-index-list\n    position: relative\n    height: 100%\n    overflow: hidden\n    .cube-scroll-wrapper\n      position: absolute\n      left: 0\n      top: 0\n      right: 0\n      bottom: 0\n      overflow: hidden\n  .cube-index-list-content\n    background: $index-list-bgc\n    border-radius: 2px\n  .cube-index-list-title\n    padding: 14px 16px\n    font-size: $fontsize-medium\n    line-height: 1.6\n    color: $index-list-title-color\n  .cube-index-list-anchor\n    padding: 16px 16px 10px 16px\n    line-height: 1\n    font-size: $fontsize-medium\n    color: $index-list-anchor-color\n    background: $index-list-anchor-bgc\n  .cube-index-list-fixed\n    z-index: 1\n    position: absolute\n    top: 0\n    left: 0\n    right: 0\n  .cube-index-list-nav\n    position: absolute\n    z-index: 30\n    right: 0\n    top: 50%\n    transform: translateY(-50%)\n    font-family: Helvetica\n    > ul\n      padding: 0\n      margin: 0\n      > li\n        padding: 6px 16px 0 16px\n        line-height: 1\n        text-align: center\n        box-sizing(border-box)\n        font-size: $fontsize-small\n        color: $index-list-nav-color\n        &.active\n          color: $index-list-nav-active-color\n        @media (max-height: 480px)\n          &\n            padding-top: 3px\n</style>\n"],"sourceRoot":"node_modules/cube-ui/src/components/index-list"}]}